# Hardware Configuration
# Hardware-specific settings for the lab setup
# This file contains physical hardware parameters and calibration values

---
# ============================================================================
# SYSTEM HARDWARE
# ============================================================================

system:
  # Lab identification
  lab_name: "Ion Trap Lab"
  location: "Xi Group"
  
  # Hardware revision
  hardware_revision: "1.0"
  
  # Safety limits
  safety:
    max_rf_voltage: 250.0       # Maximum RF voltage (Volts)
    max_piezo_voltage: 4.0      # Maximum piezo voltage (Volts)
    max_dc_voltage: 50.0        # Maximum DC voltage (Volts)
    min_dc_voltage: -1.0        # Minimum DC voltage (Volts)
    emergency_shutdown_delay: 0.1  # Seconds


# ============================================================================
# RF SYSTEM
# ============================================================================

rf_system:
  # RF generation and amplification
  frequency_mhz: 20.0           # RF trap frequency
  
  # Voltage scaling (LabVIEW to real voltage)
  # LabVIEW sends u_rf in mV (0-1400mV range)
  # Real voltage U_RF in V (0-200V range after amplifier)
  # Scale factor: 700mV input = 100V output
  voltage_scale:
    input_min_mv: 0.0
    input_max_mv: 1400.0
    output_min_v: 0.0
    output_max_v: 200.0
    scale_factor: 0.142857      # 100V / 700mV = 0.142857 V/mV
  
  # Calibration
  calibration:
    date: "2024-01-15"
    operator: "Lab Technician"
    notes: "Calibrated with 100:1 probe"


# ============================================================================
# VACUUM SYSTEM
# ============================================================================

vacuum:
  # Pressure monitoring
  gauge_type: "ion_gauge"
  
  # Safety thresholds
  pressure_thresholds:
    normal_max: 5.0e-9          # Normal operation maximum (mbar)
    warning: 1.0e-8             # Warning level (mbar)
    critical: 1.0e-7            # Critical level (mbar)
    emergency: 1.0e-6           # Emergency shutdown (mbar)
  
  # Check frequency
  check_interval_ms: 50         # 20 Hz check rate


# ============================================================================
# CAMERA HARDWARE
# ============================================================================

camera_hardware:
  # Camera model and specifications
  model: "Hamamatsu Orca"
  sensor:
    type: "sCMOS"
    width_pixels: 2048
    height_pixels: 2048
    pixel_size_um: 6.5
    bit_depth: 16
  
  # Cooling system
  cooling:
    type: "thermoelectric"
    target_temperature_c: -20.0
    max_temperature_c: 30.0
    stabilization_time_s: 300
  
  # Trigger modes
  trigger_modes:
    - "extern"                 # External TTL trigger
    - "software"               # Software trigger
    - "internal"               # Internal free-running
  
  # Acquisition modes
  acquisition_modes:
    - "single"
    - "inf"                    # Infinite mode (continuous)
    - "dcimg"                  # DCIMG recording mode
  
  # Frame rates
  frame_rates:
    max_fps: 30
    typical_exposure_ms: 300
  
  # ROI constraints
  roi_constraints:
    min_size: 4
    size_step: 4
    pos_step: 4


# ============================================================================
# LASER SYSTEM
# ============================================================================

lasers:
  # Raman lasers
  raman:
    - name: "Raman 1"
      frequency_mhz: 215.5
      wavelength_nm: 313.0
      max_power_mw: 100.0
    - name: "Raman 2"
      frequency_mhz: 215.5
      wavelength_nm: 313.0
      max_power_mw: 100.0
  
  # Cooling laser
  cooling:
    name: "UV3"
    wavelength_nm: 313.0
    max_power_mw: 50.0
  
  # Piezo tuning
  piezo:
    voltage_range: [0.0, 4.0]   # Volts
    frequency_range_mhz: [200.0, 230.0]  # Tuning range


# ============================================================================
# ELECTRODE CONFIGURATION
# ============================================================================

electrodes:
  # DC electrodes
  dc:
    - name: "EC1"
      channel: 0
      voltage_range: [-1.0, 50.0]
      default_voltage: 0.0
    - name: "EC2"
      channel: 1
      voltage_range: [-1.0, 50.0]
      default_voltage: 0.0
    - name: "CompH"
      channel: 2
      voltage_range: [-10.0, 10.0]
      default_voltage: 0.0
    - name: "CompV"
      channel: 3
      voltage_range: [-10.0, 10.0]
      default_voltage: 0.0
  
  # Endcaps
  endcaps:
    - name: "Endcap1"
      channel: 4
      voltage_range: [0.0, 100.0]
    - name: "Endcap2"
      channel: 5
      voltage_range: [0.0, 100.0]


# ============================================================================
# DEVICE MAPPING
# ============================================================================

devices:
  # Device to channel/control mapping
  mapping:
    u_rf:
      type: "analog_output"
      channel: "ao0"
      unit: "mV"
      range: [0, 1400]
    
    piezo:
      type: "analog_output"
      channel: "ao1"
      unit: "V"
      range: [0, 4]
    
    be_oven:
      type: "digital_output"
      channel: "do0"
      states: {0: "off", 1: "on"}
    
    b_field:
      type: "digital_output"
      channel: "do1"
      states: {0: "off", 1: "on"}
    
    bephi:
      type: "digital_output"
      channel: "do2"
      states: {0: "off", 1: "on"}
    
    uv3:
      type: "digital_output"
      channel: "do3"
      states: {0: "off", 1: "on"}
    
    e_gun:
      type: "digital_output"
      channel: "do4"
      states: {0: "off", 1: "on"}
    
    hd_valve:
      type: "digital_output"
      channel: "do5"
      states: {0: "closed", 1: "open"}
    
    dds:
      type: "dds"
      channel: "dds0"
      frequency_range_mhz: [0, 200]


# ============================================================================
# CALIBRATION DATA
# ============================================================================

calibration:
  # DAC calibration
  dac:
    file: "artiq/Settings/DAC/2944_dac_diff_fits.json"
    date: "2024-01-15"
    
  # Camera calibration
  camera:
    pixel_size_um: 6.5
    magnification: 10.0
    # pixel_to_um = pixel_size_um / magnification
    pixel_to_um: 0.65
